<script src="slider.js"></script>
<div class="container mt-5">
  <div class="card shadow-lg rounded-4">
    <div class="card-body">
      <h2 class="card-title text-center mb-4">Employee Details</h2>
      <hr>
      <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()">

        <!-- Personal Information Section -->
        <div class="row mb-3">
          <div class="col">
            <label for="email" class="form-label">Email:</label>
            <input type="email" class="form-control" formControlName="email" id="email" required>
          </div>
          <div class="col">
            <label for="password" class="form-label">Password:</label>
            <input type="password" class="form-control" formControlName="password" id="password" required>
          </div>
        </div>

        <div class="mb-3">
          <label for="dob">Date of Birth:</label>
          <input type="date" class="form-control" formControlName="dob" [max]="maxDate" id="dob" required>
        </div>

        <div class="mb-3">
          <label for="number">Contact Number:</label>
          <input type="tel" class="form-control" formControlName="number" id="number" required>
        </div>

        <div class="mb-3">
          <label for="altNumber">Alternate Contact Number:</label>
          <input type="tel" class="form-control" formControlName="altNumber" id="altNumber">
        </div>

        <div class="mb-3">
          <label for="address">Address:</label>
          <input type="text" class="form-control" formControlName="address" id="address" required>
        </div>

        <div class="mb-3">
          <label class="form-label">Gender:</label>
          <div *ngFor="let g of genders" class="form-check form-check-inline">
            <input class="form-check-input" type="radio" [value]="g" formControlName="gender" [id]="g">
            <label class="form-check-label" [for]="g">{{ g | titlecase }}</label>
          </div>
        </div>

        <!-- Preferences Section -->
        <div class="form-check mb-3">
          <input class="form-check-input" type="checkbox" formControlName="remember" id="remember">
          <label class="form-check-label" for="remember">Remember me</label>
        </div>

        <div class="mb-3">
          <label for="range">Experience (Years):</label>
          <div class="d-flex align-items-center gap-3">
            <input type="range" value="0" class="form-range" formControlName="experience" id="range" min="0" max="50" oninput="this.nextElementSibling.value = this.value">
            <output class="text-muted">{{employeeForm.get('experience')?.value || 0}}</output>
          </div>
        </div>

        <div class="mb-3">
          <label for="color">Favorite Color:</label>
          <div class="d-flex align-items-center gap-3">
            <input type="color" class="form-control form-control-color" formControlName="favoriteColor" id="color">
            <span class="text-muted">{{employeeForm.get('favoriteColor')?.value || '#000000'}}</span>
          </div>
        </div>

        <div class="mb-3">
          <label for="website">Personal Website:</label>
          <input type="url" class="form-control" formControlName="website" id="website">
        </div>

        <div class="mb-3">
          <label for="salary">Expected Salary:</label>
          <div class="input-group">
            <span class="input-group-text">INR</span>
            <input type="number" class="form-control" formControlName="salary" id="salary" min="0">
          </div>
        </div>

        <!-- Resume Upload Section -->
        <div class="mb-3">
          <label for="resume">Upload Resume (PDF):</label>
          <input type="file" class="form-control" id="resume" accept=".pdf" (change)="onFileSelected($event)">
          
          <!-- Error Message -->
          <div *ngIf="errorMessage" class="alert alert-danger mt-2">
            {{ errorMessage }}
          </div>
          
          <!-- Loading Indicator -->
          <div *ngIf="isLoading" class="mt-2">
            <div class="spinner-border spinner-border-sm text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <span class="ms-2">Loading preview...</span>
          </div>
        </div>

        <!-- PDF Preview -->
        <div *ngIf="fileUrl && !isLoading" class="mt-3 border rounded p-2">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="mb-0">Preview: {{ fileName }}</h5>
            <button type="button" class="btn btn-sm btn-outline-secondary" (click)="fileUrl = null; fileName = ''; employeeForm.patchValue({ resume: null })">
              <i class="bi bi-x-lg"></i> Clear
            </button>
          </div>
          <iframe 
            [src]="fileUrl" 
            width="100%" 
            height="500px" 
            style="border: 1px solid #ddd;"
            title="PDF Preview"
            class="rounded"
          ></iframe>
          <div class="text-end mt-2">
            <small class="text-muted">Note: Preview may vary by browser</small>
          </div>
        </div>

        <!-- Additional Information -->
        <div class="mb-3">
          <label for="bio">Short Bio:</label>
          <textarea class="form-control" formControlName="bio" id="bio" rows="3"></textarea>
        </div>

        <div class="mb-4">
          <label for="department">Department:</label>
          <select class="form-select" formControlName="department" id="department">
            <option value="">Select Department</option>
            <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
          </select>
        </div>

        <button class="btn btn-primary w-100 py-2" type="submit" [disabled]="employeeForm.invalid">
          <i class="bi bi-send-fill me-2"></i> Submit Application
        </button>
      </form>
    </div>
  </div>
</div>